(window.webpackJsonp=window.webpackJsonp||[]).push([["swag-pay-pal"],{"8p+u":function(t,e,n){"use strict";n.r(e);var o=n("k8s9"),r=n("u0Tz"),i=n("2Y4b"),a=n("FGIj");function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=!1,y=!1,h=[],b=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,l(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,a["a"]),n=e,(o=[{key:"createScript",value:function(t){if(h.push(t),f)y&&t.call(this);else{f=!0;var e=this.getScriptUrlOptions(),n="https://www.paypal.com/sdk/js?client-id=".concat(this.options.clientId).concat(e),o=document.createElement("script");o.type="text/javascript",o.src=n,o.addEventListener("load",this.callCallbacks.bind(this),!1),document.head.appendChild(o)}}},{key:"callCallbacks",value:function(){var t=this;h.forEach(function(e){e.call(t)}),y=!0}},{key:"getScriptUrlOptions",value:function(){var t="";return this.options.commit&&(t+="&commit=".concat(this.options.commit)),this.options.languageIso&&(t+="&locale=".concat(this.options.languageIso)),this.options.currency&&(t+="&currency=".concat(this.options.currency)),this.options.intent&&"sale"!==this.options.intent&&(t+="&intent=".concat(this.options.intent)),t+="&components=marks,buttons"}}])&&u(n.prototype,o),r&&u(n,r),e}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,w(e).apply(this,arguments))}var n,a,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(e,b),n=e,(a=[{key:"init",value:function(){this._client=new o.a(window.accessKey,window.contextToken),this.paypal=null,this.createButton()}},{key:"createButton",value:function(){var t=this;this.createScript(function(){t.paypal=window.paypal,t.renderButton()})}},{key:"renderButton",value:function(){return this.paypal.Buttons(this.getButtonConfig()).render(this.el)}},{key:"getButtonConfig",value:function(){return{style:{size:this.options.buttonSize,shape:this.options.buttonShape,color:this.options.buttonColor,tagline:this.options.tagline,layout:"horizontal",label:"checkout",height:40},createOrder:this.createOrder.bind(this),onApprove:this.onApprove.bind(this)}}},{key:"createOrder",value:function(){var t=this;return this.options.addProductToCart?this.addProductToCart().then(function(){return t._createOrder()}):this._createOrder()}},{key:"_createOrder",value:function(){var t=this;return new Promise(function(e){t._client.get(t.options.createPaymentUrl,function(t){var n=JSON.parse(t);e(n.token)})})}},{key:"addProductToCart",value:function(){var t=this,e=this._formatLineItems();return new Promise(function(n){t._client.get(t.options.createNewCartUrl,function(){t._client.post(t.options.addLineItemUrl,JSON.stringify(e),function(){n()})})})}},{key:"_formatLineItems",value:function(){var t=i.a.serializeJson(this.el.closest("form")),e={};return Object.keys(t).forEach(function(n){var o=n.match(/lineItems\[(.+)]\[(.+)]/);"redirectTo"!==n&&o&&3===o.length&&(e[o[1]]?e[o[1]][o[2]]=t[o[0]]:e[o[1]]=k({},o[2],t[o[0]]))}),{lineItems:e}}},{key:"onApprove",value:function(t,e){var n=this,o=document.querySelector(".btn.btn-light.btn-block.offcanvas-close.js-offcanvas-close.sticky-top"),i={paymentId:t.paymentID};o&&o.click(),r.a.create(document.body),this._client.post(this.options.approvePaymentUrl,JSON.stringify(i),function(){e.redirect(n.options.checkoutConfirmUrl)})}}])&&m(n.prototype,a),c&&m(n,c),e}();k(O,"options",{buttonColor:"gold",buttonShape:"rect",buttonSize:"small",languageIso:"en_GB",loginEnabled:!1,clientId:"",commit:!1,tagline:!1,addProductToCart:!1,createPaymentUrl:"",createNewCartUrl:"",addLineItemUrl:"",approvePaymentUrl:"",checkoutConfirmUrl:""});var S=n("gHbT");function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function j(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var E,B,T,U=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),j(this,C(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(e,b),n=e,(r=[{key:"init",value:function(){this.paypal=null,this._client=new o.a(window.accessKey,window.contextToken),this.createButton()}},{key:"createButton",value:function(){var t=this;this.createScript(function(){t.paypal=window.paypal,t.renderButton(),t.renderMarks()})}},{key:"renderButton",value:function(){var t=this,e=function(){S.a.querySelector(document,"input.payment-method-input[checked=checked]").value===t.options.paymentMethodId?(S.a.querySelector(document,"#confirmFormSubmit").style.display="none",t.el.style.display="block"):(S.a.querySelector(document,"#confirmFormSubmit").style.display="block",t.el.style.display="none")};e();var n=S.a.querySelector(document,".confirm-payment");return new MutationObserver(function(){e()}).observe(n,{attributes:!1,childList:!0,subtree:!1}),this.paypal.Buttons(this.getButtonConfig()).render(this.el)}},{key:"renderMarks",value:function(){var t=this;S.a.querySelectorAll(document,this.options.marksContainerSelector).forEach(function(e){t.paypal.Marks().render(e)})}},{key:"getButtonConfig",value:function(){return{style:{size:this.options.buttonSize,shape:this.options.buttonShape,color:this.options.buttonColor,label:"checkout"},createOrder:this.createOrder.bind(this),onApprove:this.onApprove.bind(this)}}},{key:"createOrder",value:function(){var t=this;return new Promise(function(e){t._client.post(t.options.createPaymentUrl,null,function(t){var n=JSON.parse(t);e(n.token)})})}},{key:"onApprove",value:function(t,e){var n=new URLSearchParams;n.append("paypalPayerId",t.payerID),n.append("paypalPaymentId",t.paymentID);var o="".concat(this.options.checkoutConfirmUrl,"?").concat(n.toString());e.redirect(o)}}])&&_(n.prototype,r),i&&_(n,i),e}();function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function z(t,e){return!e||"object"!==M(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}T={buttonColor:"gold",buttonShape:"rect",buttonSize:"small",languageIso:"en_GB",clientId:"",commit:!1,useAlternativePaymentMethods:!0,createPaymentUrl:"",checkoutConfirmUrl:"",marksContainerSelector:"[data-swag-paypal-marks-confirm]"},(B="options")in(E=U)?Object.defineProperty(E,B,{value:T,enumerable:!0,configurable:!0,writable:!0}):E[B]=T;var L=[],q=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),z(this,A(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(e,b),n=e,(o=[{key:"init",value:function(){this.paypal=null,L.push(this),this.createMarks()}},{key:"createMarks",value:function(){var t=this;this.createScript(function(){t.paypal=window.paypal,L.forEach(function(e){t.paypal.Marks().render(e.el)})})}}])&&x(n.prototype,o),r&&x(n,r),e}();!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(q,"options",{clientId:""});var N=window.PluginManager;N.register("SwagPayPalExpressButton",O,"[data-swag-paypal-express-button]"),N.register("SwagPayPalSmartPaymentButtons",U,"[data-swag-paypal-smart-payment-buttons]"),N.register("SwagPayPalMarks",q,"[data-swag-paypal-marks]")}},[["8p+u","runtime","vendor-node","vendor-shared"]]]);